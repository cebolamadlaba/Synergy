UPDATE [dbo].[tblSapDataImportConfiguration]
SET [FileImportLocation] = '\\10952appprdsdc1\Data_Dump\CMS\PricePoint\Loaded_Price', 
[FileExportLocation] = '\\10952appprdsdc1\Data_Dump\CMS\PricePoint\Approved_Price',
[SupportEmailAddress] = 'wilco@kohde.io'

GO

[dbo].[DeleteConcessionData] 1

GO

TRUNCATE TABLE [dbo].[tblProductCash]

GO

TRUNCATE TABLE [dbo].[tblProductTransactional]

GO

TRUNCATE TABLE [dbo].[tblLoadedPriceCash]

GO

TRUNCATE TABLE [dbo].[tblLoadedPriceTransactional]

GO

DELETE FROM [dbo].[rtblTableNumber]

GO

DELETE FROM [dbo].[rtblTransactionTableNumber]

GO


DECLARE
	@CashConcessionTypeId int

SELECT TOP 1 @CashConcessionTypeId = [pkConcessionTypeId] FROM [dbo].[rtblConcessionType] WHERE [Code] = 'Cash'

MERGE [dbo].[rtblTableNumber] AS TARGET
USING (VALUES (@CashConcessionTypeId,30,0,0,1),
(@CashConcessionTypeId,896,0.158,0,1),
(@CashConcessionTypeId,798,0.17,0,1),
(@CashConcessionTypeId,862,0.17,0,1),
(@CashConcessionTypeId,869,0.17,0,1),
(@CashConcessionTypeId,854,0.17,0,1),
(@CashConcessionTypeId,950,0.16,0,1),
(@CashConcessionTypeId,914,0.181,0,1),
(@CashConcessionTypeId,918,0.169,0,1),
(@CashConcessionTypeId,863,0.193,0,1),
(@CashConcessionTypeId,738,0.193,0,1),
(@CashConcessionTypeId,861,0.205,0,1),
(@CashConcessionTypeId,732,0.205,0,1),
(@CashConcessionTypeId,278,0.211,0,1),
(@CashConcessionTypeId,59,0.215,0,1),
(@CashConcessionTypeId,940,0.222,0,1),
(@CashConcessionTypeId,763,0.25,0,1),
(@CashConcessionTypeId,796,0.228,0,1),
(@CashConcessionTypeId,860,0.228,0,1),
(@CashConcessionTypeId,936,0.234,0,1),
(@CashConcessionTypeId,627,0.238,0,1),
(@CashConcessionTypeId,643,0.239,0,1),
(@CashConcessionTypeId,915,0.23,0,1),
(@CashConcessionTypeId,897,0.252,0,1),
(@CashConcessionTypeId,648,0.254,0,1),
(@CashConcessionTypeId,765,0.264,0,1),
(@CashConcessionTypeId,906,0.276,0,1),
(@CashConcessionTypeId,902,0.276,0,1),
(@CashConcessionTypeId,693,0.284,0,1),
(@CashConcessionTypeId,775,0.295,0,1),
(@CashConcessionTypeId,865,0.3,0,1),
(@CashConcessionTypeId,137,0.306,0,1),
(@CashConcessionTypeId,791,0.32,0,1),
(@CashConcessionTypeId,774,0.318,0,1),
(@CashConcessionTypeId,907,0.318,0,1),
(@CashConcessionTypeId,911,0.301,0,1),
(@CashConcessionTypeId,69,0.329,0,1),
(@CashConcessionTypeId,726,0.329,0,1),
(@CashConcessionTypeId,735,0.341,0,1),
(@CashConcessionTypeId,642,0.351,0,1),
(@CashConcessionTypeId,858,0.369,0,1),
(@CashConcessionTypeId,85,0.375,0,1),
(@CashConcessionTypeId,773,0.375,0,1),
(@CashConcessionTypeId,857,0.386,0,1),
(@CashConcessionTypeId,768,0.39,0,1),
(@CashConcessionTypeId,752,0.397,0,1),
(@CashConcessionTypeId,764,0.397,0,1),
(@CashConcessionTypeId,901,0.404,0,1),
(@CashConcessionTypeId,181,0.42,0,1),
(@CashConcessionTypeId,891,0.42,0,1),
(@CashConcessionTypeId,951,0.4,0,1),
(@CashConcessionTypeId,853,0.422,0,1),
(@CashConcessionTypeId,727,0.431,0,1),
(@CashConcessionTypeId,919,0.409,0,1),
(@CashConcessionTypeId,654,0.442,0,1),
(@CashConcessionTypeId,772,0.443,0,1),
(@CashConcessionTypeId,651,0.454,0,1),
(@CashConcessionTypeId,759,0.455,0,1),
(@CashConcessionTypeId,93,0.467,0,1),
(@CashConcessionTypeId,682,0.474,0,1),
(@CashConcessionTypeId,730,0.479,0,1),
(@CashConcessionTypeId,890,0.479,0,1),
(@CashConcessionTypeId,629,0.491,0,1),
(@CashConcessionTypeId,889,0.491,0,1),
(@CashConcessionTypeId,48,0.503,0,1),
(@CashConcessionTypeId,920,0.506,0,1),
(@CashConcessionTypeId,272,0.5,0,1),
(@CashConcessionTypeId,605,0.533,0,1),
(@CashConcessionTypeId,781,0.538,0,1),
(@CashConcessionTypeId,250,0.568,0,1),
(@CashConcessionTypeId,903,0.58,0,1),
(@CashConcessionTypeId,109,0.613,0,1),
(@CashConcessionTypeId,433,0.613,0,1),
(@CashConcessionTypeId,882,0.613,0,1),
(@CashConcessionTypeId,787,0.659,0,1),
(@CashConcessionTypeId,636,0.683,0,1),
(@CashConcessionTypeId,870,0.686,0,1),
(@CashConcessionTypeId,875,0.739,0,1),
(@CashConcessionTypeId,640,0.749,0,1),
(@CashConcessionTypeId,769,0.749,0,1),
(@CashConcessionTypeId,876,0.749,0,1),
(@CashConcessionTypeId,905,0.812,0,1),
(@CashConcessionTypeId,899,0.828,0,1),
(@CashConcessionTypeId,874,0.855,0,1),
(@CashConcessionTypeId,898,0.874,0,1),
(@CashConcessionTypeId,949,0.0085,0,1),
(@CashConcessionTypeId,797,0.909,0,1),
(@CashConcessionTypeId,91,0.922,0,1),
(@CashConcessionTypeId,767,0.934,0,1),
(@CashConcessionTypeId,766,0.957,0,1),
(@CashConcessionTypeId,910,0.981,0,1),
(@CashConcessionTypeId,913,0.95,0,1),
(@CashConcessionTypeId,921,1.021,0,1),
(@CashConcessionTypeId,793,1.034,0,1),
(@CashConcessionTypeId,788,1.137,0,1),
(@CashConcessionTypeId,877,1.15,0,1),
(@CashConcessionTypeId,879,1.656,0,1),
(@CashConcessionTypeId,904,1.672,0,1),
(@CashConcessionTypeId,908,1.66,0,1),
(@CashConcessionTypeId,789,0.683,2.5,1),
(@CashConcessionTypeId,350,1.485,2.5,1),
(@CashConcessionTypeId,868,0,3.61,1),
(@CashConcessionTypeId,256,0.222,4,1),
(@CashConcessionTypeId,916,0.351,4,1),
(@CashConcessionTypeId,62,0.475,4,1),
(@CashConcessionTypeId,318,0.934,5,1),
(@CashConcessionTypeId,933,0.158,6,1),
(@CashConcessionTypeId,747,0.205,6,1),
(@CashConcessionTypeId,925,0.227,6,1),
(@CashConcessionTypeId,909,0.238,6,1),
(@CashConcessionTypeId,924,0.25,6,1),
(@CashConcessionTypeId,440,0.264,6,1),
(@CashConcessionTypeId,439,0.275,6,1),
(@CashConcessionTypeId,799,0.288,6,1),
(@CashConcessionTypeId,690,0.3,6,1),
(@CashConcessionTypeId,635,0.318,6,1),
(@CashConcessionTypeId,546,0.318,6,1),
(@CashConcessionTypeId,602,0.327,6,1),
(@CashConcessionTypeId,866,0.329,6,1),
(@CashConcessionTypeId,708,0.341,6,1),
(@CashConcessionTypeId,33,0.38,6,1),
(@CashConcessionTypeId,32,0.4,6,1),
(@CashConcessionTypeId,249,0.45,6,1),
(@CashConcessionTypeId,31,0.505,6,1),
(@CashConcessionTypeId,883,0.386,6,1),
(@CashConcessionTypeId,885,0.397,6,1),
(@CashConcessionTypeId,136,0.45,6,1),
(@CashConcessionTypeId,271,0.401,6,1),
(@CashConcessionTypeId,97,0.411,6,1),
(@CashConcessionTypeId,51,0.431,6,1),
(@CashConcessionTypeId,65,0.455,6,1),
(@CashConcessionTypeId,668,0.479,6,1),
(@CashConcessionTypeId,107,0.503,6,1),
(@CashConcessionTypeId,634,0.506,6,1),
(@CashConcessionTypeId,37,0.533,6,1),
(@CashConcessionTypeId,723,0.544,6,1),
(@CashConcessionTypeId,670,0.568,6,1),
(@CashConcessionTypeId,895,0.578,6,1),
(@CashConcessionTypeId,45,0.578,6,1),
(@CashConcessionTypeId,685,0.59,6,1),
(@CashConcessionTypeId,637,0.613,6,1),
(@CashConcessionTypeId,700,0.613,6,1),
(@CashConcessionTypeId,663,0.647,6,1),
(@CashConcessionTypeId,680,0.67,6,1),
(@CashConcessionTypeId,705,0.683,6,1),
(@CashConcessionTypeId,659,0.694,6,1),
(@CashConcessionTypeId,660,0.707,6,1),
(@CashConcessionTypeId,709,0.717,6,1),
(@CashConcessionTypeId,701,0.717,6,1),
(@CashConcessionTypeId,698,0.73,6,1),
(@CashConcessionTypeId,83,0.749,6,1),
(@CashConcessionTypeId,702,0.749,6,1),
(@CashConcessionTypeId,683,0.771,6,1),
(@CashConcessionTypeId,887,0.783,6,1),
(@CashConcessionTypeId,671,0.783,6,1),
(@CashConcessionTypeId,699,0.805,6,1),
(@CashConcessionTypeId,893,0.84,6,1),
(@CashConcessionTypeId,661,0.84,6,1),
(@CashConcessionTypeId,686,0.875,6,1),
(@CashConcessionTypeId,707,0.898,6,1),
(@CashConcessionTypeId,652,0.934,6,1),
(@CashConcessionTypeId,269,0.95,6,1),
(@CashConcessionTypeId,689,0.976,6,1),
(@CashConcessionTypeId,687,0.998,6,1),
(@CashConcessionTypeId,695,1.032,6,1),
(@CashConcessionTypeId,711,1.055,6,1),
(@CashConcessionTypeId,692,1.077,6,1),
(@CashConcessionTypeId,658,1.101,6,1),
(@CashConcessionTypeId,666,1.125,6,1),
(@CashConcessionTypeId,688,1.162,6,1),
(@CashConcessionTypeId,664,1.191,6,1),
(@CashConcessionTypeId,674,1.248,6,1),
(@CashConcessionTypeId,667,1.304,6,1),
(@CashConcessionTypeId,694,1.317,6,1),
(@CashConcessionTypeId,152,1.377,6,1),
(@CashConcessionTypeId,684,1.418,6,1),
(@CashConcessionTypeId,343,1.452,6,1),
(@CashConcessionTypeId,703,1.485,6,1),
(@CashConcessionTypeId,655,1.497,6,1),
(@CashConcessionTypeId,679,1.579,6,1),
(@CashConcessionTypeId,650,1.656,6,1),
(@CashConcessionTypeId,696,1.712,6,1),
(@CashConcessionTypeId,656,1.783,6,1),
(@CashConcessionTypeId,697,1.905,6,1),
(@CashConcessionTypeId,665,1.929,6,1),
(@CashConcessionTypeId,681,1.998,6,1),
(@CashConcessionTypeId,347,2.035,6,1),
(@CashConcessionTypeId,746,0.205,7,1),
(@CashConcessionTypeId,436,0.275,7,1),
(@CashConcessionTypeId,691,0.3,7,1),
(@CashConcessionTypeId,437,0.318,7,1),
(@CashConcessionTypeId,545,0.318,7,1),
(@CashConcessionTypeId,66,0.351,7,1),
(@CashConcessionTypeId,645,0.363,7,1),
(@CashConcessionTypeId,274,0.375,7,1),
(@CashConcessionTypeId,42,0.386,7,1),
(@CashConcessionTypeId,282,0.397,7,1),
(@CashConcessionTypeId,946,0.411,7,1),
(@CashConcessionTypeId,762,0.431,7,1),
(@CashConcessionTypeId,64,0.5,7,1),
(@CashConcessionTypeId,741,0.477,7,1),
(@CashConcessionTypeId,776,0.479,7,1),
(@CashConcessionTypeId,673,0.503,7,1),
(@CashConcessionTypeId,744,0.533,7,1),
(@CashConcessionTypeId,120,0.544,7,1),
(@CashConcessionTypeId,177,0.568,7,1),
(@CashConcessionTypeId,888,0.568,7,1),
(@CashConcessionTypeId,657,0.578,7,1),
(@CashConcessionTypeId,225,0.601,7,1),
(@CashConcessionTypeId,101,0.613,7,1),
(@CashConcessionTypeId,121,0.613,7,1),
(@CashConcessionTypeId,678,0.622,7,1),
(@CashConcessionTypeId,46,0.647,7,1),
(@CashConcessionTypeId,35,0.67,7,1),
(@CashConcessionTypeId,104,0.683,7,1),
(@CashConcessionTypeId,604,0.694,7,1),
(@CashConcessionTypeId,105,0.707,7,1),
(@CashConcessionTypeId,884,0.707,7,1),
(@CashConcessionTypeId,193,0.717,7,1),
(@CashConcessionTypeId,706,0.717,7,1),
(@CashConcessionTypeId,56,0.73,7,1),
(@CashConcessionTypeId,276,0.739,7,1),
(@CashConcessionTypeId,737,0.749,7,1),
(@CashConcessionTypeId,263,0.771,7,1),
(@CashConcessionTypeId,50,0.783,7,1),
(@CashConcessionTypeId,96,0.805,7,1),
(@CashConcessionTypeId,52,0.836,7,1),
(@CashConcessionTypeId,43,0.84,7,1),
(@CashConcessionTypeId,881,0.84,7,1),
(@CashConcessionTypeId,108,0.844,7,1),
(@CashConcessionTypeId,258,0.875,7,1),
(@CashConcessionTypeId,34,0.876,7,1),
(@CashConcessionTypeId,438,0.934,7,1),
(@CashConcessionTypeId,745,0.95,7,1),
(@CashConcessionTypeId,124,0.976,7,1),
(@CashConcessionTypeId,892,0.976,7,1),
(@CashConcessionTypeId,894,0.976,7,1),
(@CashConcessionTypeId,190,0.998,7,1),
(@CashConcessionTypeId,197,1.032,7,1),
(@CashConcessionTypeId,234,1.055,7,1),
(@CashConcessionTypeId,601,1.077,7,1),
(@CashConcessionTypeId,170,1.101,7,1),
(@CashConcessionTypeId,53,1.125,7,1),
(@CashConcessionTypeId,653,1.162,7,1),
(@CashConcessionTypeId,99,1.191,7,1),
(@CashConcessionTypeId,317,1.248,7,1),
(@CashConcessionTypeId,95,1.304,7,1),
(@CashConcessionTypeId,886,1.304,7,1),
(@CashConcessionTypeId,116,1.317,7,1),
(@CashConcessionTypeId,44,1.377,7,1),
(@CashConcessionTypeId,128,1.418,7,1),
(@CashConcessionTypeId,273,1.452,7,1),
(@CashConcessionTypeId,117,1.485,7,1),
(@CashConcessionTypeId,129,1.497,7,1),
(@CashConcessionTypeId,132,1.579,7,1),
(@CashConcessionTypeId,131,1.656,7,1),
(@CashConcessionTypeId,112,1.712,7,1),
(@CashConcessionTypeId,133,1.783,7,1),
(@CashConcessionTypeId,419,1.905,7,1),
(@CashConcessionTypeId,138,1.929,7,1),
(@CashConcessionTypeId,140,1.998,7,1),
(@CashConcessionTypeId,141,2.04,7,1),
(@CashConcessionTypeId,926,0.422,20,1),
(@CashConcessionTypeId,900,0.068,0,1),
(@CashConcessionTypeId,855,0.124,0,1),
(@CashConcessionTypeId,751,0.143,0,1),
(@CashConcessionTypeId,676,0.144,0,1),
(@CashConcessionTypeId,614,0.137,0,1),
(@CashConcessionTypeId,952,0.15,0,1),
(@CashConcessionTypeId,880,0.151,0,1),
(@CashConcessionTypeId,86,0.158,0,1),
(@CashConcessionTypeId,944,0.158,0,1),
(@CashConcessionTypeId,912,0.167,0,1),
(@CashConcessionTypeId,778,0.185,0,1),
(@CashConcessionTypeId,761,0.189,0,1),
(@CashConcessionTypeId,948,0.19,0,1),
(@CashConcessionTypeId,938,0.21,0,1),
(@CashConcessionTypeId,782,0.222,0,1),
(@CashConcessionTypeId,760,0.223,0,1),
(@CashConcessionTypeId,779,0.235,0,1),
(@CashConcessionTypeId,780,0.242,0,1),
(@CashConcessionTypeId,748,0.248,0,1),
(@CashConcessionTypeId,603,0.249,0,1),
(@CashConcessionTypeId,758,0.189,0,1),
(@CashConcessionTypeId,731,0.262,0,1),
(@CashConcessionTypeId,644,0.262,0,1),
(@CashConcessionTypeId,942,0.263,0,1),
(@CashConcessionTypeId,864,0.269,0,1),
(@CashConcessionTypeId,749,0.275,0,1),
(@CashConcessionTypeId,628,0.28,0,1),
(@CashConcessionTypeId,725,0.309,0,1),
(@CashConcessionTypeId,777,0.309,0,1),
(@CashConcessionTypeId,728,0.314,0,1),
(@CashConcessionTypeId,941,0.315,0,1),
(@CashConcessionTypeId,646,0.326,0,1),
(@CashConcessionTypeId,750,0.328,0,1),
(@CashConcessionTypeId,754,0.328,0,1),
(@CashConcessionTypeId,721,0.342,0,1),
(@CashConcessionTypeId,757,0.346,0,1),
(@CashConcessionTypeId,631,0.35,0,1),
(@CashConcessionTypeId,739,0.353,0,1),
(@CashConcessionTypeId,704,0.363,0,1),
(@CashConcessionTypeId,724,0.373,0,1),
(@CashConcessionTypeId,734,0.373,0,1),
(@CashConcessionTypeId,733,0.385,0,1),
(@CashConcessionTypeId,647,0.408,0,1),
(@CashConcessionTypeId,756,0.408,0,1),
(@CashConcessionTypeId,937,0.42,0,1),
(@CashConcessionTypeId,742,0.442,0,1),
(@CashConcessionTypeId,753,0.458,0,1),
(@CashConcessionTypeId,856,0.481,0,1),
(@CashConcessionTypeId,662,0.482,0,1),
(@CashConcessionTypeId,755,0.495,0,1),
(@CashConcessionTypeId,675,0.565,0,1),
(@CashConcessionTypeId,736,0.606,0,1),
(@CashConcessionTypeId,156,0.788,0,1),
(@CashConcessionTypeId,710,0.946,0,1),
(@CashConcessionTypeId,771,0.981,0,1),
(@CashConcessionTypeId,740,1.049,0,1),
(@CashConcessionTypeId,729,1.551,0,1),
(@CashConcessionTypeId,859,0,1.5,1),
(@CashConcessionTypeId,119,0.455,4.18,1),
(@CashConcessionTypeId,619,0.526,4.18,1),
(@CashConcessionTypeId,36,0.613,6,1),
(@CashConcessionTypeId,39,0.669,7,1),
(@CashConcessionTypeId,40,0.964,7,1),
(@CashConcessionTypeId,41,1.089,7,1),
(@CashConcessionTypeId,47,0.669,6,1),
(@CashConcessionTypeId,49,0.964,7,1),
(@CashConcessionTypeId,55,0.522,6,1),
(@CashConcessionTypeId,63,0.84,7,1),
(@CashConcessionTypeId,67,0.964,6,1),
(@CashConcessionTypeId,94,1.089,6,1),
(@CashConcessionTypeId,125,1.21,6,1),
(@CashConcessionTypeId,281,0.964,6,1),
(@CashConcessionTypeId,283,0.84,6,1),
(@CashConcessionTypeId,669,1.067,6,1),
(@CashConcessionTypeId,785,1.225,0,1),
(@CashConcessionTypeId,786,1.872,0,1),
(@CashConcessionTypeId,945,2.5,7,1),
(@CashConcessionTypeId,139,2.75,7,1),
(@CashConcessionTypeId,199,2.75,7,1),
(@CashConcessionTypeId,260,2.75,7,1),
(@CashConcessionTypeId,284,2.35,6,1),
(@CashConcessionTypeId,302,2.75,7,1),
(@CashConcessionTypeId,639,2.75,7,1),
(@CashConcessionTypeId,716,2.35,6,1),
(@CashConcessionTypeId,300,0.9,4,1),
(@CashConcessionTypeId,638,0.9,4,1),
(@CashConcessionTypeId,715,1.05,6,1),
(@CashConcessionTypeId,213,1.9,8,1),
(@CashConcessionTypeId,130,1.39,7,1))
AS SOURCE ([ConcessionTypeId], [TariffTable], [AdValorem], [BaseRate], [IsActive])
ON TARGET.[TariffTable] = SOURCE.[TariffTable] AND TARGET.[fkConcessionTypeId] = SOURCE.[ConcessionTypeId]
WHEN MATCHED THEN
UPDATE SET [AdValorem] = SOURCE.[AdValorem], [BaseRate] = SOURCE.[BaseRate], [IsActive] = SOURCE.[IsActive]
WHEN NOT MATCHED BY SOURCE THEN
UPDATE SET [IsActive] = 0
WHEN NOT MATCHED BY TARGET THEN
INSERT ([fkConcessionTypeId], [TariffTable], [AdValorem], [BaseRate], [IsActive]) 
VALUES (SOURCE.[ConcessionTypeId], SOURCE.[TariffTable], SOURCE.[AdValorem], SOURCE.[BaseRate], SOURCE.[IsActive]);

GO

DECLARE
	@ChequeServiceFeeTransactionTypeId int

SELECT TOP 1 @ChequeServiceFeeTransactionTypeId = [pkTransactionTypeId] FROM [dbo].[rtblTransactionType]
WHERE [fkConcessionTypeId] = (
SELECT TOP 1 [pkConcessionTypeId] FROM [dbo].[rtblConcessionType] WHERE [Code] = 'Transactional')
AND [Description] = 'Cheque Service Fee'

MERGE [dbo].[rtblTransactionTableNumber] AS TARGET
USING (VALUES (@ChequeServiceFeeTransactionTypeId,231,70,NULL,1),
(@ChequeServiceFeeTransactionTypeId,119,0,NULL,1),
(@ChequeServiceFeeTransactionTypeId,189,12.35976,NULL,1),
(@ChequeServiceFeeTransactionTypeId,197,0,NULL,1),
(@ChequeServiceFeeTransactionTypeId,806,0,NULL,1),
(@ChequeServiceFeeTransactionTypeId,850,0,NULL,1),
(@ChequeServiceFeeTransactionTypeId,805,5.255,NULL,1),
(@ChequeServiceFeeTransactionTypeId,192,3.090976181,NULL,1),
(@ChequeServiceFeeTransactionTypeId,250,3.153,NULL,1),
(@ChequeServiceFeeTransactionTypeId,105,4.636464271,NULL,1),
(@ChequeServiceFeeTransactionTypeId,175,5.255,NULL,1),
(@ChequeServiceFeeTransactionTypeId,848,4.945561889,NULL,1),
(@ChequeServiceFeeTransactionTypeId,808,5.098132474,NULL,1),
(@ChequeServiceFeeTransactionTypeId,259,7.79842,NULL,1),
(@ChequeServiceFeeTransactionTypeId,184,4.08130626,NULL,1),
(@ChequeServiceFeeTransactionTypeId,811,5.530621861,NULL,1),
(@ChequeServiceFeeTransactionTypeId,202,5.28,NULL,1),
(@ChequeServiceFeeTransactionTypeId,174,5.897582553,NULL,1),
(@ChequeServiceFeeTransactionTypeId,859,6.159697333,NULL,1),
(@ChequeServiceFeeTransactionTypeId,206,6.170288301,NULL,1),
(@ChequeServiceFeeTransactionTypeId,195,6.181952362,NULL,1),
(@ChequeServiceFeeTransactionTypeId,196,6.181952362,NULL,1),
(@ChequeServiceFeeTransactionTypeId,814,6.181952362,NULL,1),
(@ChequeServiceFeeTransactionTypeId,860,6.193616423,NULL,1),
(@ChequeServiceFeeTransactionTypeId,815,6.86303,NULL,1),
(@ChequeServiceFeeTransactionTypeId,857,6.57926,NULL,1),
(@ChequeServiceFeeTransactionTypeId,858,6.58977,NULL,1),
(@ChequeServiceFeeTransactionTypeId,810,6.670821155,NULL,1),
(@ChequeServiceFeeTransactionTypeId,812,7.339213844,NULL,1),
(@ChequeServiceFeeTransactionTypeId,813,0,NULL,1),
(@ChequeServiceFeeTransactionTypeId,849,8.8,NULL,1),
(@ChequeServiceFeeTransactionTypeId,225,5.255,NULL,1),
(@ChequeServiceFeeTransactionTypeId,855,16.77396,NULL,1),
(@ChequeServiceFeeTransactionTypeId,809,11.66406106,NULL,1),
(@ChequeServiceFeeTransactionTypeId,102,17,NULL,1),
(@ChequeServiceFeeTransactionTypeId,154,12.36390472,NULL,1),
(@ChequeServiceFeeTransactionTypeId,223,15.765,NULL,1),
(@ChequeServiceFeeTransactionTypeId,203,21,NULL,1),
(@ChequeServiceFeeTransactionTypeId,856,17.03746071,NULL,1),
(@ChequeServiceFeeTransactionTypeId,74,17.43,NULL,1),
(@ChequeServiceFeeTransactionTypeId,851,17.49609159,NULL,1),
(@ChequeServiceFeeTransactionTypeId,142,18.54585709,NULL,1),
(@ChequeServiceFeeTransactionTypeId,176,33,NULL,1),
(@ChequeServiceFeeTransactionTypeId,185,37,NULL,1),
(@ChequeServiceFeeTransactionTypeId,854,42,NULL,1),
(@ChequeServiceFeeTransactionTypeId,126,32.76434752,NULL,1),
(@ChequeServiceFeeTransactionTypeId,852,37.09171417,NULL,1),
(@ChequeServiceFeeTransactionTypeId,134,50,NULL,1),
(@ChequeServiceFeeTransactionTypeId,153,48,NULL,1),
(@ChequeServiceFeeTransactionTypeId,98,50,NULL,1),
(@ChequeServiceFeeTransactionTypeId,151,50,NULL,1),
(@ChequeServiceFeeTransactionTypeId,114,60,NULL,1),
(@ChequeServiceFeeTransactionTypeId,139,75,NULL,1),
(@ChequeServiceFeeTransactionTypeId,57,80,NULL,1),
(@ChequeServiceFeeTransactionTypeId,138,95,NULL,1),
(@ChequeServiceFeeTransactionTypeId,62,100,NULL,1),
(@ChequeServiceFeeTransactionTypeId,124,100,NULL,1),
(@ChequeServiceFeeTransactionTypeId,141,100,NULL,1))
AS SOURCE ([TransactionTypeId], [TariffTable], [Fee], [AdValorem], [IsActive])
ON TARGET.[TariffTable] = SOURCE.[TariffTable] AND TARGET.[fkTransactionTypeId] = SOURCE.[TransactionTypeId]
WHEN MATCHED THEN
UPDATE SET [AdValorem] = SOURCE.[AdValorem], [Fee] = SOURCE.[Fee], [IsActive] = SOURCE.[IsActive]
WHEN NOT MATCHED BY TARGET THEN
INSERT ([fkTransactionTypeId], [TariffTable], [AdValorem], [Fee], [IsActive]) 
VALUES (SOURCE.[TransactionTypeId], SOURCE.[TariffTable], SOURCE.[AdValorem], SOURCE.[Fee], SOURCE.[IsActive]);

GO

DECLARE
	@ChequeEncashmentFeeTransactionTypeId int

SELECT TOP 1 @ChequeEncashmentFeeTransactionTypeId = [pkTransactionTypeId] FROM [dbo].[rtblTransactionType]
WHERE [fkConcessionTypeId] = (
SELECT TOP 1 [pkConcessionTypeId] FROM [dbo].[rtblConcessionType] WHERE [Code] = 'Transactional')
AND [Description] = 'Cheque Encashment Fee'

MERGE [dbo].[rtblTransactionTableNumber] AS TARGET
USING (VALUES (@ChequeEncashmentFeeTransactionTypeId,1,0,0,1),
(@ChequeEncashmentFeeTransactionTypeId,89,25.5,0.008123352,1),
(@ChequeEncashmentFeeTransactionTypeId,158,225,0,1),
(@ChequeEncashmentFeeTransactionTypeId,159,477,0,1),
(@ChequeEncashmentFeeTransactionTypeId,254,55,0,1),
(@ChequeEncashmentFeeTransactionTypeId,412,33.75,0.007091816,1),
(@ChequeEncashmentFeeTransactionTypeId,534,8.3157,0,1),
(@ChequeEncashmentFeeTransactionTypeId,591,7.90776,0,1),
(@ChequeEncashmentFeeTransactionTypeId,900,11.64198,0,1),
(@ChequeEncashmentFeeTransactionTypeId,1105,39,0,1),
(@ChequeEncashmentFeeTransactionTypeId,1139,6.276,0.019961269,1),
(@ChequeEncashmentFeeTransactionTypeId,1169,53,0,1),
(@ChequeEncashmentFeeTransactionTypeId,1181,0,0.014570457,1),
(@ChequeEncashmentFeeTransactionTypeId,1273,60,0,1),
(@ChequeEncashmentFeeTransactionTypeId,1326,105,0,1),
(@ChequeEncashmentFeeTransactionTypeId,1348,76.5,0,1),
(@ChequeEncashmentFeeTransactionTypeId,1401,36,0,1),
(@ChequeEncashmentFeeTransactionTypeId,1443,0,0.015730936,1),
(@ChequeEncashmentFeeTransactionTypeId,1447,35.955168,0,1),
(@ChequeEncashmentFeeTransactionTypeId,1555,39,0.0122495,1),
(@ChequeEncashmentFeeTransactionTypeId,1589,50,0.0198,1),
(@ChequeEncashmentFeeTransactionTypeId,1590,44,0.0176,1),
(@ChequeEncashmentFeeTransactionTypeId,1591,38.5,0.0154,1),
(@ChequeEncashmentFeeTransactionTypeId,1688,39,0.013538921,1),
(@ChequeEncashmentFeeTransactionTypeId,1749,0,0.008,1),
(@ChequeEncashmentFeeTransactionTypeId,1769,36.075,0,1),
(@ChequeEncashmentFeeTransactionTypeId,1773,36,0.008381237,1),
(@ChequeEncashmentFeeTransactionTypeId,1775,190.5,0,1),
(@ChequeEncashmentFeeTransactionTypeId,1777,36,0.011604789,1),
(@ChequeEncashmentFeeTransactionTypeId,1786,0,0.018051894,1),
(@ChequeEncashmentFeeTransactionTypeId,1803,39,0.011604789,1),
(@ChequeEncashmentFeeTransactionTypeId,1830,39,0.01289421,1),
(@ChequeEncashmentFeeTransactionTypeId,1873,0,0.014828342,1),
(@ChequeEncashmentFeeTransactionTypeId,1885,39,0.014183631,1),
(@ChequeEncashmentFeeTransactionTypeId,1931,0,0.015473052,1),
(@ChequeEncashmentFeeTransactionTypeId,1940,48,0.014828342,1),
(@ChequeEncashmentFeeTransactionTypeId,1943,43.5,0.014828342,1),
(@ChequeEncashmentFeeTransactionTypeId,1959,16.5,0,1),
(@ChequeEncashmentFeeTransactionTypeId,2020,153,0,1),
(@ChequeEncashmentFeeTransactionTypeId,2041,14.25,0,1),
(@ChequeEncashmentFeeTransactionTypeId,2046,18,0,1),
(@ChequeEncashmentFeeTransactionTypeId,2047,27,0,1),
(@ChequeEncashmentFeeTransactionTypeId,2050,30,0,1),
(@ChequeEncashmentFeeTransactionTypeId,2054,34.5,0,1),
(@ChequeEncashmentFeeTransactionTypeId,2058,57,0,1),
(@ChequeEncashmentFeeTransactionTypeId,2060,63,0,1),
(@ChequeEncashmentFeeTransactionTypeId,2062,75,0,1),
(@ChequeEncashmentFeeTransactionTypeId,2069,0,0.003868263,1),
(@ChequeEncashmentFeeTransactionTypeId,2071,0,0.007117604,1),
(@ChequeEncashmentFeeTransactionTypeId,2072,0,0.007891257,1),
(@ChequeEncashmentFeeTransactionTypeId,2074,0,0.00897437,1),
(@ChequeEncashmentFeeTransactionTypeId,2075,0,0.010960079,1),
(@ChequeEncashmentFeeTransactionTypeId,2076,0,0.011604789,1),
(@ChequeEncashmentFeeTransactionTypeId,2077,0,0.01191425,1),
(@ChequeEncashmentFeeTransactionTypeId,2078,0,0.012378442,1),
(@ChequeEncashmentFeeTransactionTypeId,2079,0,0.014183631,1),
(@ChequeEncashmentFeeTransactionTypeId,2080,0,0.014235208,1),
(@ChequeEncashmentFeeTransactionTypeId,2081,0,0.015937244,1),
(@ChequeEncashmentFeeTransactionTypeId,2087,9,0.013152094,1),
(@ChequeEncashmentFeeTransactionTypeId,2088,16.5,0.00897437,1),
(@ChequeEncashmentFeeTransactionTypeId,2089,16.5,0.009593292,1),
(@ChequeEncashmentFeeTransactionTypeId,2090,21,0.010057484,1),
(@ChequeEncashmentFeeTransactionTypeId,2092,22.5,0.010676406,1),
(@ChequeEncashmentFeeTransactionTypeId,2094,25.5,0.011450058,1),
(@ChequeEncashmentFeeTransactionTypeId,2096,0,0.011450058,1),
(@ChequeEncashmentFeeTransactionTypeId,2097,27,0.013306825,1),
(@ChequeEncashmentFeeTransactionTypeId,2098,30,0.007117604,1),
(@ChequeEncashmentFeeTransactionTypeId,2099,30,0.00897437,1),
(@ChequeEncashmentFeeTransactionTypeId,2101,0,0.0068,1),
(@ChequeEncashmentFeeTransactionTypeId,2104,0,0.005260838,1),
(@ChequeEncashmentFeeTransactionTypeId,2105,31.5,0.006343951,1),
(@ChequeEncashmentFeeTransactionTypeId,2106,31.5,0.007891257,1),
(@ChequeEncashmentFeeTransactionTypeId,2107,31.5,0.009283831,1),
(@ChequeEncashmentFeeTransactionTypeId,2108,31.5,0.009593292,1),
(@ChequeEncashmentFeeTransactionTypeId,2111,0,0.009593292,1),
(@ChequeEncashmentFeeTransactionTypeId,2112,31.5,0.010676406,1),
(@ChequeEncashmentFeeTransactionTypeId,2113,31.5,0.00897437,1),
(@ChequeEncashmentFeeTransactionTypeId,2118,34.5,0.010366945,1),
(@ChequeEncashmentFeeTransactionTypeId,2121,34.5,0.011450058,1),
(@ChequeEncashmentFeeTransactionTypeId,2123,0,0.012533172,1),
(@ChequeEncashmentFeeTransactionTypeId,2124,34.5,0.01191425,1),
(@ChequeEncashmentFeeTransactionTypeId,2129,0,0.020269698,1),
(@ChequeEncashmentFeeTransactionTypeId,2135,34.5,0.006653412,1),
(@ChequeEncashmentFeeTransactionTypeId,2136,34.5,0.007891257,1),
(@ChequeEncashmentFeeTransactionTypeId,2138,34.5,0.010960079,1),
(@ChequeEncashmentFeeTransactionTypeId,2147,36,0.009670658,1),
(@ChequeEncashmentFeeTransactionTypeId,2162,36,0.011862673,1),
(@ChequeEncashmentFeeTransactionTypeId,2167,36,0.012223711,1),
(@ChequeEncashmentFeeTransactionTypeId,2168,36,0.012378442,1),
(@ChequeEncashmentFeeTransactionTypeId,2169,36,0.013538921,1),
(@ChequeEncashmentFeeTransactionTypeId,2172,36,0.016117763,1),
(@ChequeEncashmentFeeTransactionTypeId,2182,36,0.01289421,1),
(@ChequeEncashmentFeeTransactionTypeId,2186,40.5,0.01289421,1),
(@ChequeEncashmentFeeTransactionTypeId,2191,40.5,0.00897437,1),
(@ChequeEncashmentFeeTransactionTypeId,2192,40.5,0.011604789,1),
(@ChequeEncashmentFeeTransactionTypeId,2195,40.5,0.013538921,1),
(@ChequeEncashmentFeeTransactionTypeId,2209,45,0.014828342,1),
(@ChequeEncashmentFeeTransactionTypeId,2211,382.5,0,1),
(@ChequeEncashmentFeeTransactionTypeId,2465,12.552,0,1),
(@ChequeEncashmentFeeTransactionTypeId,2472,36,0.00881964,1),
(@ChequeEncashmentFeeTransactionTypeId,2477,0,0.003558802,1),
(@ChequeEncashmentFeeTransactionTypeId,2484,0,0.00881964,1),
(@ChequeEncashmentFeeTransactionTypeId,2488,0,0.012223711,1),
(@ChequeEncashmentFeeTransactionTypeId,2489,0,0.013925747,1),
(@ChequeEncashmentFeeTransactionTypeId,2658,32.4,0.003558802,1),
(@ChequeEncashmentFeeTransactionTypeId,2751,45,0.015627783,1),
(@ChequeEncashmentFeeTransactionTypeId,2777,50.4,0.015627783,1),
(@ChequeEncashmentFeeTransactionTypeId,2825,59.4,0.012223711,1),
(@ChequeEncashmentFeeTransactionTypeId,2994,52.5,0,1),
(@ChequeEncashmentFeeTransactionTypeId,3010,40.5,0.012687903,1),
(@ChequeEncashmentFeeTransactionTypeId,3023,40.5,0.013925747,1),
(@ChequeEncashmentFeeTransactionTypeId,3029,45,0.013925747,1),
(@ChequeEncashmentFeeTransactionTypeId,3032,45,0.014080477,1),
(@ChequeEncashmentFeeTransactionTypeId,3036,45,0.014544669,1),
(@ChequeEncashmentFeeTransactionTypeId,3045,28.2,0.0103,1),
(@ChequeEncashmentFeeTransactionTypeId,3048,52.2,0.015318321,1),
(@ChequeEncashmentFeeTransactionTypeId,3051,48.6,0.014544669,1),
(@ChequeEncashmentFeeTransactionTypeId,3064,48.6,0.01485413,1),
(@ChequeEncashmentFeeTransactionTypeId,3071,0,0.01794874,1),
(@ChequeEncashmentFeeTransactionTypeId,3072,0,0.001856766,1),
(@ChequeEncashmentFeeTransactionTypeId,3086,0,0.02088862,1),
(@ChequeEncashmentFeeTransactionTypeId,3097,31.5,0.00293988,1),
(@ChequeEncashmentFeeTransactionTypeId,3099,190.8,0,1),
(@ChequeEncashmentFeeTransactionTypeId,3100,135,0,1),
(@ChequeEncashmentFeeTransactionTypeId,3101,0,0.002785149,1),
(@ChequeEncashmentFeeTransactionTypeId,3107,171,0,1),
(@ChequeEncashmentFeeTransactionTypeId,3109,10.8,0,1),
(@ChequeEncashmentFeeTransactionTypeId,3114,0,0.019496046,1),
(@ChequeEncashmentFeeTransactionTypeId,3117,0,0.003404071,1),
(@ChequeEncashmentFeeTransactionTypeId,3119,6.11136,0.018805164,1),
(@ChequeEncashmentFeeTransactionTypeId,3122,0,0.0022155,1),
(@ChequeEncashmentFeeTransactionTypeId,3123,7.2,0.022900117,1),
(@ChequeEncashmentFeeTransactionTypeId,3133,48.6,0.022281195,1),
(@ChequeEncashmentFeeTransactionTypeId,3135,48.6,0.02073389,1),
(@ChequeEncashmentFeeTransactionTypeId,3136,0,0.077210529,1),
(@ChequeEncashmentFeeTransactionTypeId,3141,0,0.060654364,1),
(@ChequeEncashmentFeeTransactionTypeId,3142,6.53,0,1),
(@ChequeEncashmentFeeTransactionTypeId,3145,405,0,1),
(@ChequeEncashmentFeeTransactionTypeId,3148,48.6,0.008200718,1),
(@ChequeEncashmentFeeTransactionTypeId,3164,0,0.000464192,1),
(@ChequeEncashmentFeeTransactionTypeId,3200,21.3082752,0,1),
(@ChequeEncashmentFeeTransactionTypeId,3201,41.2847832,0,1),
(@ChequeEncashmentFeeTransactionTypeId,3203,39.225,0.019556648,1),
(@ChequeEncashmentFeeTransactionTypeId,3204,39.225,0.006743672,1),
(@ChequeEncashmentFeeTransactionTypeId,3147,40,0.022,1),
(@ChequeEncashmentFeeTransactionTypeId,3227,40.5,0.0187,1),
(@ChequeEncashmentFeeTransactionTypeId,3233,698.91105,0,1),
(@ChequeEncashmentFeeTransactionTypeId,3234,11.7675,0,1),
(@ChequeEncashmentFeeTransactionTypeId,3237,35.3025,0,1),
(@ChequeEncashmentFeeTransactionTypeId,3238,59.929524,0,1),
(@ChequeEncashmentFeeTransactionTypeId,3239,7.016568,0,1),
(@ChequeEncashmentFeeTransactionTypeId,3242,4.907832,0,1),
(@ChequeEncashmentFeeTransactionTypeId,3243,0,0.016977257,1),
(@ChequeEncashmentFeeTransactionTypeId,3248,150,0,1),
(@ChequeEncashmentFeeTransactionTypeId,3249,25.78301299,0,1),
(@ChequeEncashmentFeeTransactionTypeId,3250,12.67842374,0,1),
(@ChequeEncashmentFeeTransactionTypeId,3312,27.6,0.0032705,1),
(@ChequeEncashmentFeeTransactionTypeId,3277,NULL,0.0024265,1))
AS SOURCE ([TransactionTypeId], [TariffTable], [Fee], [AdValorem], [IsActive])
ON TARGET.[TariffTable] = SOURCE.[TariffTable] AND TARGET.[fkTransactionTypeId] = SOURCE.[TransactionTypeId]
WHEN MATCHED THEN
UPDATE SET [AdValorem] = SOURCE.[AdValorem], [Fee] = SOURCE.[Fee], [IsActive] = SOURCE.[IsActive]
WHEN NOT MATCHED BY TARGET THEN
INSERT ([fkTransactionTypeId], [TariffTable], [AdValorem], [Fee], [IsActive]) 
VALUES (SOURCE.[TransactionTypeId], SOURCE.[TariffTable], SOURCE.[AdValorem], SOURCE.[Fee], SOURCE.[IsActive]);

GO

DECLARE
	@ChequeDepositFeeTransactionTypeId int

SELECT TOP 1 @ChequeDepositFeeTransactionTypeId = [pkTransactionTypeId] FROM [dbo].[rtblTransactionType]
WHERE [fkConcessionTypeId] = (
SELECT TOP 1 [pkConcessionTypeId] FROM [dbo].[rtblConcessionType] WHERE [Code] = 'Transactional')
AND [Description] = 'Cheque Deposit Fee'

MERGE [dbo].[rtblTransactionTableNumber] AS TARGET
USING (VALUES (@ChequeDepositFeeTransactionTypeId,1989, 32.00,NULL,1),
(@ChequeDepositFeeTransactionTypeId,456, 20.00,NULL,1),
(@ChequeDepositFeeTransactionTypeId,457, 10.50,NULL,1),
(@ChequeDepositFeeTransactionTypeId,1, 0,NULL,1))
AS SOURCE ([TransactionTypeId], [TariffTable], [Fee], [AdValorem], [IsActive])
ON TARGET.[TariffTable] = SOURCE.[TariffTable] AND TARGET.[fkTransactionTypeId] = SOURCE.[TransactionTypeId]
WHEN MATCHED THEN
UPDATE SET [AdValorem] = SOURCE.[AdValorem], [Fee] = SOURCE.[Fee], [IsActive] = SOURCE.[IsActive]
WHEN NOT MATCHED BY TARGET THEN
INSERT ([fkTransactionTypeId], [TariffTable], [AdValorem], [Fee], [IsActive]) 
VALUES (SOURCE.[TransactionTypeId], SOURCE.[TariffTable], SOURCE.[AdValorem], SOURCE.[Fee], SOURCE.[IsActive]);

GO

DECLARE
	@MinMonthlyServiceFeeTransactionTypeId int

SELECT TOP 1 @MinMonthlyServiceFeeTransactionTypeId = [pkTransactionTypeId] FROM [dbo].[rtblTransactionType]
WHERE [fkConcessionTypeId] = (
SELECT TOP 1 [pkConcessionTypeId] FROM [dbo].[rtblConcessionType] WHERE [Code] = 'Transactional')
AND [Description] = 'Minimum Monthly Service Fee'

MERGE [dbo].[rtblTransactionTableNumber] AS TARGET
USING (VALUES (@MinMonthlyServiceFeeTransactionTypeId,500, 0,NULL,1))
AS SOURCE ([TransactionTypeId], [TariffTable], [Fee], [AdValorem], [IsActive])
ON TARGET.[TariffTable] = SOURCE.[TariffTable] AND TARGET.[fkTransactionTypeId] = SOURCE.[TransactionTypeId]
WHEN MATCHED THEN
UPDATE SET [AdValorem] = SOURCE.[AdValorem], [Fee] = SOURCE.[Fee], [IsActive] = SOURCE.[IsActive]
WHEN NOT MATCHED BY TARGET THEN
INSERT ([fkTransactionTypeId], [TariffTable], [AdValorem], [Fee], [IsActive]) 
VALUES (SOURCE.[TransactionTypeId], SOURCE.[TariffTable], SOURCE.[AdValorem], SOURCE.[Fee], SOURCE.[IsActive]);

GO